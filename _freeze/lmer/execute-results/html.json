{
  "hash": "17786fe02347e721a8f27c2c603c2c04",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Mixed-effects model\"\nformat: html\n---\n\n\n\n\n\nLinear mixed models (LMMs) are statistical models that incorporate **fixed** and **random** effects to accurately represent **non-independent** data structures. LMM is an alternative to analysis of variance.\n\n- Fixed effects are non-random and assumed to be constant for the whole population.\n- Random effects introduce statistical variability at different levels of the data hierarchy, account for the unmeasured sources of variance that affect certain groups in the data\n\nModels with both fixed and random-effects are called mixed-effect models.\n\n## Notation\n\n$$y = X\\beta + Zu + \\varepsilon$$\n\n- $y$ is a vector of observations\n- $X$ is the design matrix for the fixed effects\n- $\\beta$ is a vector of fixed-effect parameters\n- $Z$ is the design matrix for the random effects\n- $u$ is a vector of random-effect parameters\n- $\\varepsilon$ is a vector of random errors\n\n## A simple example\n\nWe want to predict ***test score*** $y$ from ***hours studied*** $x$ in 2 classrooms $i \\in \\{1,2\\}$, each classroom has 3 students $j \\in \\{1,2,3\\}$.\n\n### Random intercept\n\n$$y = X\\beta + Zu + \\varepsilon$$\n\n$$\n\\left[\\begin{array}{ll}\ny_{11} \\\\\ny_{12} \\\\\ny_{13} \\\\\ny_{21} \\\\\ny_{22} \\\\\ny_{23}\n\\end{array}\\right]=\\left[\\begin{array}{ll}\n1 & x_{11} \\\\\n1 & x_{12} \\\\\n1 & x_{13} \\\\\n1 & x_{21} \\\\\n1 & x_{22} \\\\\n1 & x_{23}\n\\end{array}\\right] \\left[\\begin{array}{l}\n\\beta_0 \\\\\n\\beta_1\n\\end{array}\\right] + \n\\left[\\begin{array}{ll}\n1 & 0 \\\\\n1 & 0 \\\\\n1 & 0 \\\\\n0 & 1 \\\\\n0 & 1 \\\\\n0 & 1\n\\end{array}\\right] \\left[\\begin{array}{l}\nb_{0_1} \\\\\nb_{0_2}\n\\end{array}\\right] + \\varepsilon\n$$\n\n$$\\begin{align}\ny_{ij} &= \\beta_0 + \\beta_1 x_{ij} + b_{0_i} + \\varepsilon \\\\\n&= \\underbrace{\\beta_0 + b_{0_i}}_\\text{intercept} + \\underbrace{\\beta_1}_\\text{slope} x_{ij} + \\varepsilon\n\\end{align}$$\n\n- The intercept for classroom 1 is $\\beta_0 + b_{0_1}$\n- The intercept for classroom 2 is $\\beta_0 + b_{0_2}$\n- The slope is $\\beta_1$\n\n### Random slope\n\n$$y = X\\beta + Zu + \\varepsilon$$\n\n$$\n\\left[\\begin{array}{ll}\ny_{11} \\\\\ny_{12} \\\\\ny_{13} \\\\\ny_{21} \\\\\ny_{22} \\\\\ny_{23}\n\\end{array}\\right]=\\left[\\begin{array}{ll}\n1 & x_{11} \\\\\n1 & x_{12} \\\\\n1 & x_{13} \\\\\n1 & x_{21} \\\\\n1 & x_{22} \\\\\n1 & x_{23}\n\\end{array}\\right] \\left[\\begin{array}{l}\n\\beta_0 \\\\\n\\beta_1\n\\end{array}\\right] + \n\\left[\\begin{array}{ll}\nx_{11} & 0 \\\\\nx_{12} & 0 \\\\\nx_{13} & 0 \\\\\n0 & x_{21} \\\\\n0 & x_{22} \\\\\n0 & x_{23}\n\\end{array}\\right] \\left[\\begin{array}{l}\nb_{1_1} \\\\\nb_{1_2}\n\\end{array}\\right] + \\varepsilon\n$$\n\n$$\\begin{align}\ny_{ij} &= \\beta_0 + \\beta_1 x_{ij} + b_{1_i} x_{ij} + \\varepsilon \\\\\n&= \\underbrace{\\beta_0}_\\text{intercept} + \\underbrace{(\\beta_1 + b_{1_i})}_\\text{slope} x_{ij} + \\varepsilon\n\\end{align}$$\n\n### Random intercept and random slope\n\n$$y = X\\beta + Zu + \\varepsilon$$\n\n$$\n\\left[\\begin{array}{ll}\ny_{11} \\\\\ny_{12} \\\\\ny_{13} \\\\\ny_{21} \\\\\ny_{22} \\\\\ny_{23}\n\\end{array}\\right]=\\left[\\begin{array}{ll}\n1 & x_{11} \\\\\n1 & x_{12} \\\\\n1 & x_{13} \\\\\n1 & x_{21} \\\\\n1 & x_{22} \\\\\n1 & x_{23}\n\\end{array}\\right] \\left[\\begin{array}{l}\n\\beta_0 \\\\\n\\beta_1\n\\end{array}\\right] + \n\\left[\\begin{array}{ll}\n1 & x_{11} & 0 & 0 \\\\\n1 & x_{12} & 0 & 0 \\\\\n1 & x_{13} & 0 & 0 \\\\\n0 & 0 & 1 & x_{21} \\\\\n0 & 0 & 1 & x_{22} \\\\\n0 & 0 & 1 & x_{23}\n\\end{array}\\right] \\left[\\begin{array}{l}\nb_{0_1} \\\\\nb_{1_1} \\\\\nb_{0_2} \\\\\nb_{1_2}\n\\end{array}\\right] + \\varepsilon\n$$\n\n$$\\begin{align}\ny_{ij} &= \\beta_0 + \\beta_1 x_{ij} + b_{0_i} + b_{1_i} x_{ij} + \\varepsilon \\\\\n&= \\underbrace{\\beta_0 + b_{0_i}}_\\text{intercept} + \\underbrace{(\\beta_1 + b_{1_i})}_\\text{slope} x_{ij} + \\varepsilon\n\\end{align}$$\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- read.csv(\"data/classroom.csv\")\n```\n:::\n\n\n\n\n\n## Random effects\n\n\n\n$$y \\sim \\beta_i x + \\varepsilon$$\n\n$$\\beta_i \\sim \\text{Normal}(\\mu, \\sigma)$$\n\nRandom effect assumes that $\\beta_i$ is drawn from $\\text{Normal}(\\mu, \\sigma)$.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Random intercept\nlmer(y ~ x + (1 | random_group), data = my_data)\n\n# Random slope\nlmer(y ~ x + (random_slope | random_group), data = my_data)\n```\n:::\n\n\n\n\n\nRandom-effect explains more variability than the fixed-effect WHY???\n\nslopes are being estimated for each classroom, but include a shared distribution. This shared distribution pools information from all classrooms\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}